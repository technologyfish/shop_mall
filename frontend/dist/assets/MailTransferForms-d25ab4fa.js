import{_ as C,r as h,J as M,o as T,z as y,Q as m,b as l,d as f,e as b,f as p,i as t,ah as z,w as s,j as _,l as V,t as k,k as D,P as F}from"./index-dc0220d7.js";import{f as I}from"./format-d9fb0471.js";const $={class:"mail-transfer-forms-page"},E={class:"card"},N={class:"filter-bar"},P={key:1,class:"text-gray"},S={class:"pagination"},A={__name:"MailTransferForms",setup(K){const u=h([]),g=h(0),n=M({keyword:"",page:1,per_page:15});T(()=>{i()});const i=async()=>{try{const c=localStorage.getItem("admin_token"),e=await y.get("http://localhost:8000/api/admin/mail-transfer/forms",{params:n,headers:{Authorization:`Bearer ${c}`}});u.value=e.data.data.data||[],g.value=e.data.data.total||0}catch{m.error("获取表单列表失败")}},w=async c=>{var e,d;try{await F.confirm("确定要删除这条记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const o=localStorage.getItem("admin_token");await y.delete(`http://localhost:8000/api/admin/mail-transfer/forms/${c}`,{headers:{Authorization:`Bearer ${o}`}}),m.success("删除成功"),i()}catch(o){o!=="cancel"&&m.error(((d=(e=o.response)==null?void 0:e.data)==null?void 0:d.message)||"删除失败")}};return(c,e)=>{const d=l("el-input"),o=l("el-button"),r=l("el-table-column"),v=l("el-tag"),x=l("el-table"),B=l("el-pagination");return f(),b("div",$,[e[4]||(e[4]=p("h1",{class:"page-title"},"MailTransfer收集",-1)),p("div",E,[p("div",N,[t(d,{modelValue:n.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>n.keyword=a),placeholder:"搜索昵称/邮箱",style:{width:"300px"},onKeyup:z(i,["enter"])},null,8,["modelValue"]),t(o,{type:"primary",onClick:i},{default:s(()=>[...e[2]||(e[2]=[_("搜索",-1)])]),_:1})]),t(x,{data:u.value,style:{width:"100%"}},{default:s(()=>[t(r,{prop:"id",label:"ID",width:"80"}),t(r,{prop:"nickname",label:"昵称",width:"150"}),t(r,{prop:"email",label:"邮箱",width:"250"}),t(r,{prop:"off_code",label:"Off Code",width:"150"},{default:s(({row:a})=>[a.off_code?(f(),V(v,{key:0,type:"success",size:"small"},{default:s(()=>[_(k(a.off_code),1)]),_:2},1024)):(f(),b("span",P,"-"))]),_:1}),t(r,{prop:"created_at",label:"提交时间",width:"180"},{default:s(({row:a})=>[_(k(D(I)(a.created_at)),1)]),_:1}),t(r,{label:"操作",width:"100",fixed:"right"},{default:s(({row:a})=>[t(o,{text:"",type:"danger",onClick:U=>w(a.id)},{default:s(()=>[...e[3]||(e[3]=[_("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),p("div",S,[t(B,{"current-page":n.page,"onUpdate:currentPage":e[1]||(e[1]=a=>n.page=a),total:g.value,"page-size":n.per_page,layout:"total, prev, pager, next",onCurrentChange:i},null,8,["current-page","total","page-size"])])])])}}},O=C(A,[["__scopeId","data-v-1063c6bb"]]);export{O as default};
