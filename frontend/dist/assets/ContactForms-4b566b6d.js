import{a as H,b as K,d as L}from"./contact-6118f72a.js";import{f as F}from"./format-d9fb0471.js";import{_ as O,J as B,r as b,o as W,b as n,ab as X,d as g,e as Y,i as e,w as a,Q as y,f as h,j as o,C as Z,l as k,t as i,k as U,h as V,P as ee}from"./index-dc0220d7.js";const te={class:"contact-forms-page"},ae={style:{"white-space":"pre-wrap"}},le={__name:"ContactForms",setup(oe){const d=B({status:null,keyword:""}),x=b([]),w=b(!1),r=B({current:1,pageSize:15,total:0}),f=b(!1),s=b(null),c=async()=>{w.value=!0;try{const u={page:r.current,per_page:r.pageSize,status:d.status,keyword:d.keyword},v=(await H(u)).data.data;x.value=v.data||[],r.total=v.total||0}catch{y.error("获取数据失败")}finally{w.value=!1}},I=()=>{r.current=1,c()},N=()=>{d.status=null,d.keyword="",r.current=1,c()},$=u=>{s.value=u,f.value=!0},z=async u=>{try{await K(u.id,1),y.success("状态更新成功"),c()}catch{y.error("状态更新失败")}},E=async()=>{await z(s.value),f.value=!1},M=async u=>{try{await ee.confirm("确定要删除这条记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await L(u.id),y.success("删除成功"),c()}catch(t){t!=="cancel"&&y.error("删除失败")}};return W(()=>{c()}),(u,t)=>{const v=n("el-option"),P=n("el-select"),C=n("el-form-item"),T=n("el-input"),_=n("el-button"),j=n("el-form"),p=n("el-table-column"),S=n("el-tag"),J=n("el-table"),Q=n("el-pagination"),R=n("el-card"),m=n("el-descriptions-item"),q=n("el-descriptions"),A=n("el-dialog"),G=X("loading");return g(),Y("div",te,[e(R,null,{header:a(()=>[...t[6]||(t[6]=[h("div",{class:"card-header"},[h("h2",null,"Contact表单提交记录")],-1)])]),default:a(()=>[e(j,{inline:!0,class:"search-form"},{default:a(()=>[e(C,{label:"状态"},{default:a(()=>[e(P,{modelValue:d.status,"onUpdate:modelValue":t[0]||(t[0]=l=>d.status=l),placeholder:"全部",clearable:"",style:{width:"120px"}},{default:a(()=>[e(v,{label:"未处理",value:0}),e(v,{label:"已处理",value:1})]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"关键词"},{default:a(()=>[e(T,{modelValue:d.keyword,"onUpdate:modelValue":t[1]||(t[1]=l=>d.keyword=l),placeholder:"姓名/邮箱/电话",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(C,null,{default:a(()=>[e(_,{type:"primary",onClick:I},{default:a(()=>[...t[7]||(t[7]=[o("搜索",-1)])]),_:1}),e(_,{onClick:N},{default:a(()=>[...t[8]||(t[8]=[o("重置",-1)])]),_:1})]),_:1})]),_:1}),Z((g(),k(J,{data:x.value,border:""},{default:a(()=>[e(p,{prop:"id",label:"ID",width:"80"}),e(p,{prop:"name",label:"姓名",width:"120"}),e(p,{prop:"email",label:"邮箱",width:"200"}),e(p,{prop:"phone",label:"电话",width:"150"}),e(p,{prop:"comment",label:"留言内容","show-overflow-tooltip":""}),e(p,{prop:"status",label:"状态",width:"100"},{default:a(({row:l})=>[e(S,{type:l.status===1?"success":"info"},{default:a(()=>[o(i(l.status===1?"已处理":"未处理"),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"created_at",label:"提交时间",width:"180"},{default:a(({row:l})=>[o(i(U(F)(l.created_at)),1)]),_:1}),e(p,{label:"操作",width:"180",fixed:"right"},{default:a(({row:l})=>[e(_,{link:"",type:"primary",size:"small",onClick:D=>$(l)},{default:a(()=>[...t[9]||(t[9]=[o(" 查看 ",-1)])]),_:1},8,["onClick"]),l.status===0?(g(),k(_,{key:0,link:"",type:"primary",size:"small",onClick:D=>z(l)},{default:a(()=>[...t[10]||(t[10]=[o(" 标记已处理 ",-1)])]),_:1},8,["onClick"])):V("",!0),e(_,{link:"",type:"danger",size:"small",onClick:D=>M(l)},{default:a(()=>[...t[11]||(t[11]=[o(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,w.value]]),e(Q,{"current-page":r.current,"onUpdate:currentPage":t[2]||(t[2]=l=>r.current=l),"page-size":r.pageSize,"onUpdate:pageSize":t[3]||(t[3]=l=>r.pageSize=l),"page-sizes":[10,20,50,100],total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c,onCurrentChange:c,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1}),e(A,{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=l=>f.value=l),title:"表单详情",width:"600px"},{footer:a(()=>[e(_,{onClick:t[4]||(t[4]=l=>f.value=!1)},{default:a(()=>[...t[12]||(t[12]=[o("关闭",-1)])]),_:1}),s.value&&s.value.status===0?(g(),k(_,{key:0,type:"primary",onClick:E},{default:a(()=>[...t[13]||(t[13]=[o(" 标记已处理 ",-1)])]),_:1})):V("",!0)]),default:a(()=>[s.value?(g(),k(q,{key:0,column:1,border:""},{default:a(()=>[e(m,{label:"姓名"},{default:a(()=>[o(i(s.value.name),1)]),_:1}),e(m,{label:"邮箱"},{default:a(()=>[o(i(s.value.email),1)]),_:1}),e(m,{label:"电话"},{default:a(()=>[o(i(s.value.phone||"-"),1)]),_:1}),e(m,{label:"留言内容"},{default:a(()=>[h("div",ae,i(s.value.comment),1)]),_:1}),e(m,{label:"IP地址"},{default:a(()=>[o(i(s.value.ip||"-"),1)]),_:1}),e(m,{label:"状态"},{default:a(()=>[e(S,{type:s.value.status===1?"success":"info"},{default:a(()=>[o(i(s.value.status===1?"已处理":"未处理"),1)]),_:1},8,["type"])]),_:1}),e(m,{label:"提交时间"},{default:a(()=>[o(i(U(F)(s.value.created_at)),1)]),_:1})]),_:1})):V("",!0)]),_:1},8,["modelValue"])])}}},ue=O(le,[["__scopeId","data-v-875ba271"]]);export{ue as default};
