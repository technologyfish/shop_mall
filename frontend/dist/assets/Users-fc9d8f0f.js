import{_ as $,r as y,J as j,o as J,al as Q,b as r,d as p,e as k,f as m,i as e,ah as q,w as a,j as s,l as b,t as d,k as x,am as A,Q as U,an as F}from"./index-dc0220d7.js";import{f as h}from"./format-d9fb0471.js";const G={class:"admin-users-page"},H={class:"card"},L={class:"filter-bar"},R={key:2,class:"text-gray"},W={class:"pagination"},X={key:2},Y={__name:"Users",setup(Z){const C=y([]),z=y(0),g=y(!1),u=y({}),i=j({keyword:"",status:null,is_subscriber:null,page:1,per_page:15});J(()=>{f()});const f=async()=>{const n=await Q(i);C.value=n.data.data.data||[],z.value=n.data.data.total||0},N=async n=>{try{const t=Number(n.status);await A(n.id,{status:t}),U.success("状态更新成功")}catch(t){U.error(t.message||"操作失败"),n.status=Number(n.status)===1?0:1}},B=async n=>{try{const t=await F(n);u.value=t.data.data,g.value=!0}catch{U.error("获取详情失败")}},O=n=>({0:"warning",1:"primary",3:"success",4:"info"})[n]||"info",T=n=>({0:"待支付",1:"待发货",3:"已完成",4:"已取消"})[n]||"未知";return(n,t)=>{const E=r("el-input"),v=r("el-option"),S=r("el-select"),D=r("el-button"),o=r("el-table-column"),_=r("el-tag"),I=r("el-switch"),w=r("el-table"),K=r("el-pagination"),c=r("el-descriptions-item"),M=r("el-descriptions"),P=r("el-dialog");return p(),k("div",G,[t[15]||(t[15]=m("h1",{class:"page-title"},"用户管理",-1)),m("div",H,[m("div",L,[e(E,{modelValue:i.keyword,"onUpdate:modelValue":t[0]||(t[0]=l=>i.keyword=l),placeholder:"搜索用户名/邮箱",style:{width:"300px"},onKeyup:q(f,["enter"])},null,8,["modelValue"]),e(S,{modelValue:i.status,"onUpdate:modelValue":t[1]||(t[1]=l=>i.status=l),placeholder:"用户状态",clearable:"",onChange:f},{default:a(()=>[e(v,{label:"正常",value:1}),e(v,{label:"禁用",value:0})]),_:1},8,["modelValue"]),e(S,{modelValue:i.is_subscriber,"onUpdate:modelValue":t[2]||(t[2]=l=>i.is_subscriber=l),placeholder:"订阅状态",clearable:"",onChange:f},{default:a(()=>[e(v,{label:"订阅用户",value:1}),e(v,{label:"非订阅用户",value:0})]),_:1},8,["modelValue"]),e(D,{onClick:f},{default:a(()=>[...t[5]||(t[5]=[s("搜索",-1)])]),_:1})]),e(w,{data:C.value,style:{width:"100%"}},{default:a(()=>[e(o,{prop:"id",label:"ID",width:"80"}),e(o,{prop:"username",label:"用户名"}),e(o,{prop:"email",label:"邮箱"}),e(o,{prop:"phone",label:"手机号"}),e(o,{label:"用户标识",width:"100"},{default:a(({row:l})=>[l.is_subscriber>0?(p(),b(_,{key:0,type:"success",size:"small"},{default:a(()=>[...t[6]||(t[6]=[s("订阅用户",-1)])]),_:1})):(p(),b(_,{key:1,type:"info",size:"small"},{default:a(()=>[...t[7]||(t[7]=[s("普通用户",-1)])]),_:1}))]),_:1}),e(o,{label:"首单优惠",width:"100"},{default:a(({row:l})=>[l.first_order_discount===1?(p(),b(_,{key:0,type:"success",size:"small"},{default:a(()=>[...t[8]||(t[8]=[s("激活",-1)])]),_:1})):l.off_code?(p(),b(_,{key:1,type:"info",size:"small"},{default:a(()=>[...t[9]||(t[9]=[s("已使用",-1)])]),_:1})):(p(),k("span",R,"-"))]),_:1}),e(o,{label:"状态",width:"100"},{default:a(({row:l})=>[e(I,{modelValue:l.status,"onUpdate:modelValue":V=>l.status=V,"active-value":1,"inactive-value":0,onChange:V=>N(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(o,{prop:"created_at",label:"注册时间",width:"180"},{default:a(({row:l})=>[s(d(x(h)(l.created_at)),1)]),_:1}),e(o,{label:"操作",width:"100"},{default:a(({row:l})=>[e(D,{text:"",onClick:V=>B(l.id)},{default:a(()=>[...t[10]||(t[10]=[s("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),m("div",W,[e(K,{"current-page":i.page,"onUpdate:currentPage":t[3]||(t[3]=l=>i.page=l),total:z.value,"page-size":i.per_page,layout:"total, prev, pager, next",onCurrentChange:f},null,8,["current-page","total","page-size"])])]),e(P,{modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=l=>g.value=l),title:"用户详情",width:"800px"},{default:a(()=>[e(M,{column:2,border:""},{default:a(()=>[e(c,{label:"用户名"},{default:a(()=>[s(d(u.value.username),1)]),_:1}),e(c,{label:"昵称"},{default:a(()=>[s(d(u.value.nickname||"-"),1)]),_:1}),e(c,{label:"邮箱"},{default:a(()=>[s(d(u.value.email),1)]),_:1}),e(c,{label:"手机号"},{default:a(()=>[s(d(u.value.phone||"-"),1)]),_:1}),e(c,{label:"注册时间"},{default:a(()=>[s(d(x(h)(u.value.created_at)),1)]),_:1}),e(c,{label:"状态"},{default:a(()=>[e(_,{type:u.value.status===1?"success":"danger"},{default:a(()=>[s(d(u.value.status===1?"正常":"禁用"),1)]),_:1},8,["type"])]),_:1}),e(c,{label:"首单优惠"},{default:a(()=>[u.value.first_order_discount===1?(p(),b(_,{key:0,type:"success"},{default:a(()=>[...t[11]||(t[11]=[s("激活",-1)])]),_:1})):u.value.off_code?(p(),b(_,{key:1,type:"info"},{default:a(()=>[...t[12]||(t[12]=[s("已使用",-1)])]),_:1})):(p(),k("span",X,"-"))]),_:1}),e(c,{label:"Off Code"},{default:a(()=>[s(d(u.value.off_code||"-"),1)]),_:1})]),_:1}),t[13]||(t[13]=m("div",{class:"section-title"},"收货地址",-1)),e(w,{data:u.value.addresses||[],border:"",style:{"margin-top":"10px"}},{default:a(()=>[e(o,{prop:"name",label:"收货人",width:"100"}),e(o,{prop:"phone",label:"电话",width:"120"}),e(o,{label:"地址"},{default:a(({row:l})=>[s(d(l.province)+" "+d(l.city)+" "+d(l.district)+" "+d(l.detail),1)]),_:1})]),_:1},8,["data"]),t[14]||(t[14]=m("div",{class:"section-title"},"最近订单",-1)),e(w,{data:u.value.orders||[],border:"",style:{"margin-top":"10px"}},{default:a(()=>[e(o,{prop:"order_no",label:"订单号",width:"180"}),e(o,{prop:"pay_amount",label:"金额",width:"100"}),e(o,{label:"状态",width:"100"},{default:a(({row:l})=>[e(_,{type:O(l.status),size:"small"},{default:a(()=>[s(d(T(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(o,{prop:"created_at",label:"下单时间"},{default:a(({row:l})=>[s(d(x(h)(l.created_at)),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}},ae=$(Y,[["__scopeId","data-v-90d8c52f"]]);export{ae as default};
