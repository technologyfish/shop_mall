import{_ as N,I as R,u as V,a as j,c as d,r as p,o as z,b as _,d as L,e as E,i as t,f as e,n as S,w as s,t as U,K as I,k as r,W as J,X as K,Y as T,l as W,h as X,Z as Y,$ as Z,a0 as $,a1 as q}from"./index-dc0220d7.js";import{P as G}from"./PageLoading-2caa7b90.js";const H={class:"user-center-layout"},Q={class:"container"},ee={class:"layout-wrapper"},te={class:"user-info"},ae={class:"avatar-section"},se={class:"avatar"},ne=["src","alt"],oe={class:"avatar-overlay"},re={class:"username"},le={class:"join-date"},ue={class:"nav-menu"},ie="https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",ce={__name:"UserCenterLayout",setup(de){const f=R(),m=V(),l=j(),i=d(()=>l.userInfo),g=p(0),y=p(null),u=p(!0),x=async()=>{u.value=!0;try{await l.logout(),m.push("/login")}catch(o){I.error("Failed to sign out"),console.error("Logout error:",o)}finally{u.value=!1}},h=d(()=>f.path==="/user-center"||f.path==="/user-center/"),A=d(()=>h.value),D=d(()=>!h.value);z(async()=>{u.value=!0;try{l.userInfo||await l.fetchUserInfo()}finally{u.value=!1}});const M=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"}):"",B=()=>{y.value.click()},O=async o=>{const a=o.target.files[0];if(!a)return;const n=new FormData;n.append("file",a);try{await l.updateAvatar(n)}catch(v){console.error(v),I.error("Failed to upload avatar")}},P=()=>{m.push("/user-center/profile")};return(o,a)=>{var b,C,w,k;const n=_("el-icon"),v=_("el-badge"),c=_("router-link"),F=_("router-view");return L(),E("div",H,[t(G,{visible:u.value,text:"Loading..."},null,8,["visible"]),e("div",Q,[e("div",ee,[e("aside",{class:S(["sidebar",{"mobile-hidden":!A.value}])},[e("div",te,[e("div",ae,[e("div",{class:"avatar-wrapper",onClick:B},[e("div",se,[e("img",{src:((b=i.value)==null?void 0:b.avatar)||ie,alt:(C=i.value)==null?void 0:C.username},null,8,ne)]),e("div",oe,[t(n,null,{default:s(()=>[t(r(J))]),_:1}),a[0]||(a[0]=e("span",null,"Change Avatar",-1))]),e("input",{type:"file",ref_key:"avatarInput",ref:y,accept:"image/*",style:{display:"none"},onChange:O},null,544)]),e("button",{class:"mobile-edit-btn",onClick:P},[t(n,null,{default:s(()=>[t(r(K))]),_:1})])]),e("h3",re,U(((w=i.value)==null?void 0:w.username)||"User"),1),e("p",le,"Joined "+U(M((k=i.value)==null?void 0:k.created_at)),1)]),e("nav",ue,[t(c,{to:"/user-center/orders",class:"nav-item"},{default:s(()=>[t(n,null,{default:s(()=>[t(r(T))]),_:1}),a[1]||(a[1]=e("span",null,"My Orders",-1)),g.value?(L(),W(v,{key:0,value:g.value,class:"badge"},null,8,["value"])):X("",!0)]),_:1}),t(c,{to:"/user-center/profile",class:"nav-item"},{default:s(()=>[t(n,null,{default:s(()=>[t(r(Y))]),_:1}),a[2]||(a[2]=e("span",null,"Personal Info",-1))]),_:1}),t(c,{to:"/user-center/addresses",class:"nav-item"},{default:s(()=>[t(n,null,{default:s(()=>[t(r(Z))]),_:1}),a[3]||(a[3]=e("span",null,"Addresses",-1))]),_:1}),t(c,{to:"/user-center/subscriptions",class:"nav-item"},{default:s(()=>[t(n,null,{default:s(()=>[t(r($))]),_:1}),a[4]||(a[4]=e("span",null,"My Subscriptions",-1))]),_:1}),e("div",{onClick:x,class:"nav-item"},[t(n,null,{default:s(()=>[t(r(q))]),_:1}),a[5]||(a[5]=e("span",null,"Sign out",-1))])])],2),e("main",{class:S(["main-content",{"mobile-hidden":!D.value}])},[t(F)],2)])])])}}},pe=N(ce,[["__scopeId","data-v-173ace7c"]]);export{pe as default};
