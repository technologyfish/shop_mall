import{_ as C,a9 as z,r as _,c as f,q as g,b as d,d as l,e as i,i as o,w as u,f as v,A,k as h,a6 as E,R as N,t as R,h as $,Q as s}from"./index-dc0220d7.js";import{g as j}from"./image-da0f5490.js";/* empty css                                                                    */const q={class:"image-upload"},D={key:0,class:"image-preview"},H={class:"image-actions"},L={key:1,class:"upload-trigger"},Q={key:0,class:"upload-tip"},W={__name:"ImageUpload",props:{modelValue:{type:String,default:""},tip:{type:String,default:"建议尺寸：800x600，支持jpg、png、gif、webp，最大5MB"}},emits:["update:modelValue"],setup(c,{emit:w}){const p=c,U=w,V=z(),r=_(p.modelValue),n=f(()=>j(r.value)),k="https://www.aizhong168.cn",y=f(()=>`${k}/api/admin/upload`),B=_({Authorization:`Bearer ${V.token}`});g(()=>p.modelValue,e=>{r.value=e}),g(r,e=>{U("update:modelValue",e)});const x=e=>{const a=e.type.startsWith("image/"),t=e.size/1024/1024<5;return a?t?!0:(s.error("图片大小不能超过 5MB！"),!1):(s.error("只能上传图片文件！"),!1)},I=e=>{var a;if(e.code===0||e.code===200||e.url){const t=((a=e.data)==null?void 0:a.url)||e.url;if(!t){s.error("上传失败：未返回图片地址");return}r.value=t,s.success("上传成功")}else s.error(e.message||"上传失败")},S=e=>{console.error("Upload error:",e),s.error("上传失败，请重试")},M=()=>{r.value=""};return(e,a)=>{const t=d("el-image"),m=d("el-icon"),b=d("el-upload");return l(),i("div",q,[o(b,{action:y.value,headers:B.value,"show-file-list":!1,"on-success":I,"on-error":S,"before-upload":x,accept:"image/*"},{default:u(()=>[n.value?(l(),i("div",D,[o(t,{src:n.value,fit:"cover","preview-src-list":[n.value]},null,8,["src","preview-src-list"]),v("div",H,[o(m,{onClick:A(M,["stop"])},{default:u(()=>[o(h(E))]),_:1})])])):(l(),i("div",L,[o(m,{class:"avatar-uploader-icon"},{default:u(()=>[o(h(N))]),_:1}),a[0]||(a[0]=v("div",{class:"upload-text"},"点击上传图片",-1))]))]),_:1},8,["action","headers"]),c.tip?(l(),i("div",Q,R(c.tip),1)):$("",!0)])}}},K=C(W,[["__scopeId","data-v-916f2f29"]]);export{K as I};
